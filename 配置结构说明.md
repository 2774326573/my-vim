# Vim 配置文件结构说明

## 📂 新的文件结构

```
~/.vimrc                        主配置文件（加载所有配置）
~/vimfiles/
├── plugins.vim                 插件声明（vim-plug）
├── settings.vim                基础 Vim 设置
├── plugin-config.vim           插件特定配置
├── keymaps.vim                 所有快捷键映射
├── 快捷键指南.md               完整中文文档
├── 速查卡.md                   快速参考卡
├── 安装指南.md                 安装和故障排查
├── README.md                   项目说明
└── install.sh                  安装脚本
```

## 📝 各文件职责

### 1. `~/.vimrc` (7 行)
主配置文件，按顺序加载：
```vim
source ~/vimfiles/plugins.vim        " 插件列表
source ~/vimfiles/settings.vim       " 基础设置
source ~/vimfiles/plugin-config.vim  " 插件配置
source ~/vimfiles/keymaps.vim        " 快捷键
```

### 2. `plugins.vim` (53 行)
**职责**：插件声明
- 所有 `Plug` 命令
- 按功能分类（主题、编辑、Git、LSP 等）
- 不包含配置，只声明要安装的插件

**示例**：
```vim
call plug#begin("~/.vim/plugged")
Plug 'neoclide/coc.nvim', {'branch': 'release'}
Plug 'preservim/nerdtree'
call plug#end()
```

### 3. `settings.vim` (68 行)
**职责**：Vim 基础设置
- `set` 选项配置
- Leader 键设置
- WSL 剪贴板集成
- 文件类型自动命令
- 不包含插件相关设置

**内容**：
- 编码设置
- 界面选项（行号、光标、符号列）
- 编辑行为（缩进、搜索、撤销）
- 性能优化

### 4. `plugin-config.vim` (60 行)
**职责**：插件专用配置
- 插件变量 `let g:xxx`
- 插件选项设置
- 主题配置
- 不包含快捷键

**内容**：
- Coc.nvim 扩展列表
- NERDTree 选项
- EasyMotion 配置
- 主题切换命令
- Lightline 状态栏

### 5. `keymaps.vim` (203 行)
**职责**：所有快捷键映射
- 所有 `nnoremap`、`vnoremap` 等
- 按功能分组
- 包含插件相关快捷键

**分组**：
- 基础操作（保存、退出）
- 文件操作（FZF）
- 窗口管理
- Buffer/Tab 管理
- 编辑增强
- LSP 操作
- Git 操作
- 调试和构建

## 🎯 优势

### 清晰分离
- ✅ 每个文件职责单一
- ✅ 易于查找和修改
- ✅ 便于版本控制

### 易于维护
- ✅ 添加插件：只改 `plugins.vim`
- ✅ 调整设置：只改 `settings.vim`
- ✅ 修改快捷键：只改 `keymaps.vim`
- ✅ 配置插件：只改 `plugin-config.vim`

### 模块化
- ✅ 可以注释掉某个 source 行来禁用整个模块
- ✅ 可以轻松分享特定配置
- ✅ 便于调试（知道问题在哪个文件）

## 📋 常见操作

### 添加新插件
1. 编辑 `~/vimfiles/plugins.vim`
2. 添加 `Plug` 行
3. 运行 `:PlugInstall`
4. （可选）在 `plugin-config.vim` 添加配置
5. （可选）在 `keymaps.vim` 添加快捷键

### 修改快捷键
1. 编辑 `~/vimfiles/keymaps.vim`
2. 找到对应的映射
3. 修改或添加新的映射
4. 重启 Vim 或 `:source ~/.vimrc`

### 调整基础设置
1. 编辑 `~/vimfiles/settings.vim`
2. 修改 `set` 选项
3. 重启 Vim

### 配置插件选项
1. 编辑 `~/vimfiles/plugin-config.vim`
2. 修改 `let g:xxx` 变量
3. 重启 Vim

## 🔍 查找配置

### 我想知道某个功能在哪配置？

| 功能 | 文件 | 示例 |
|------|------|------|
| 行号、主题、编码 | `settings.vim` | `set number` |
| 快捷键 | `keymaps.vim` | `nnoremap <leader>w` |
| 插件选项 | `plugin-config.vim` | `let g:NERDTreeShowHidden` |
| 安装的插件 | `plugins.vim` | `Plug 'xxx/xxx'` |

### 快速搜索
```bash
# 搜索某个配置
cd ~/vimfiles
grep -n "NERDTree" *.vim

# 搜索快捷键
grep -n "<leader>e" keymaps.vim

# 查看所有 set 选项
grep "^set" settings.vim
```

## 🚀 开始使用

1. **确认配置已更新**：
   ```bash
   cat ~/.vimrc
   ```
   应该看到 4 个 source 命令

2. **打开 Vim**：
   ```bash
   vim
   ```

3. **安装插件**：
   ```vim
   :PlugInstall
   ```

4. **检查配置加载**：
   ```vim
   :scriptnames
   ```
   应该看到所有 4 个配置文件

## 💡 小贴士

- **备份**：旧的 `config.vim` 已备份为 `config.vim.backup`
- **恢复**：如果有问题，可以恢复旧配置
- **调试**：使用 `:verbose map <leader>e` 查看快捷键定义位置
- **重载**：修改后执行 `:source ~/.vimrc` 重新加载

## 📚 相关文档

- **快捷键列表**：`~/vimfiles/速查卡.md`
- **完整指南**：`~/vimfiles/快捷键指南.md`
- **安装帮助**：`~/vimfiles/安装指南.md`

---

**现在配置更清晰、更易维护了！** 🎉
